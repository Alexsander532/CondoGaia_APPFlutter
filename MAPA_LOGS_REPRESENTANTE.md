# ğŸ“ MAPA DE LOGS - Sistema de Mensagens (Completo)

## ğŸ¯ Mapa Visual de Todos os Logs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ğŸŸ¦ PORTARIA_REP (Azul Claro)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ initState() chamado                                                          â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ”„ [PORTARIA_REP] Chamando AuthService.getCurrentRepresentante()            â”‚
â”‚   â†“                                                                          â”‚
â”‚ âœ… [PORTARIA_REP] Representante obtido com sucesso                          â”‚
â”‚    ğŸ“Œ ID: <uuid>                                                            â”‚
â”‚    ğŸ“Œ Nome: <nome>                                                          â”‚
â”‚    ğŸ“Œ CPF: <cpf>                                                            â”‚
â”‚   â†“                                                                          â”‚
â”‚ âœ… [PORTARIA_REP] Estado atualizado com representante                       â”‚
â”‚   â†“                                                                          â”‚
â”‚ _buildMensagemTab() chamado                                                 â”‚
â”‚   â†“                                                                          â”‚
â”‚ âœ… [PORTARIA_REP] Representante carregado com sucesso                       â”‚
â”‚    ğŸ“Œ ID a passar para ConversasSimples: <uuid>                             â”‚
â”‚    ğŸ“Œ Nome a passar para ConversasSimples: <nome>                           â”‚
â”‚    ğŸ“Œ Condominio ID: <uuid>                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸŸ© CONVERSAS_SIMPLES (Verde Claro)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ StreamBuilder escuta conversas                                              â”‚
â”‚   â†“                                                                          â”‚
â”‚ UsuÃ¡rio clica em conversa                                                   â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸŸ© [CONVERSAS_SIMPLES] â•â•â• ABRINDO CONVERSA â•â•â•                            â”‚
â”‚    ğŸ“Œ Conversa ID: <uuid>                                                   â”‚
â”‚    ğŸ“Œ UsuÃ¡rio: <nome>                                                       â”‚
â”‚    ğŸ“Œ Unidade: <nÃºmero>                                                     â”‚
â”‚    ğŸ“Œ Representante ID (widget): <uuid>                                     â”‚
â”‚    ğŸ“Œ Representante Nome (widget): <nome>                                   â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ“ [CONVERSAS_SIMPLES] Marcando conversa como lida...                      â”‚
â”‚   â†“                                                                          â”‚
â”‚   âœ… [CONVERSAS_SIMPLES] Conversa marcada como lida                         â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ”µ [CONVERSAS_SERVICE] Marcando conversa como lida                         â”‚
â”‚    ğŸ“Œ Conversa ID: <uuid>                                                   â”‚
â”‚    ğŸ“Œ Para Representante: true                                              â”‚
â”‚    ğŸ“Œ Limpando nÃ£o-lidas do representante                                   â”‚
â”‚    ğŸ”„ Atualizando no Supabase...                                            â”‚
â”‚    âœ… Conversa marcada como lida                                            â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ”€ [CONVERSAS_SIMPLES] Navegando para ChatRepresentanteScreenV2...         â”‚
â”‚   â†“                                                                          â”‚
â”‚ âœ… [CONVERSAS_SIMPLES] Tela de chat aberta                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ğŸŸª CHAT_REPRESENTANTE_V2 (Roxo Claro)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tela de chat aberta                                                         â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸŸª [CHAT_REP_V2] â•â•â• INICIALIZANDO TELA â•â•â•                                â”‚
â”‚    ğŸ“Œ Conversa ID: <uuid>                                                   â”‚
â”‚    ğŸ“Œ Condominio ID: <uuid>                                                 â”‚
â”‚    ğŸ“Œ Representante ID: <uuid>                                              â”‚
â”‚    ğŸ“Œ Representante Nome: <nome>                                            â”‚
â”‚    ğŸ“Œ UsuÃ¡rio: <nome>                                                       â”‚
â”‚    ğŸ“Œ Unidade: <nÃºmero>                                                     â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ“ [CHAT_REP_V2] Marcando conversa <uuid> como lida...                      â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ”µ [CONVERSAS_SERVICE] Marcando conversa como lida                         â”‚
â”‚    ğŸ“Œ Conversa ID: <uuid>                                                   â”‚
â”‚    ğŸ“Œ Para Representante: true                                              â”‚
â”‚    âœ… Conversa marcada como lida                                            â”‚
â”‚   â†“                                                                          â”‚
â”‚ âœ… [CHAT_REP_V2] Conversa marcada como lida                                 â”‚
â”‚   â†“                                                                          â”‚
â”‚ UsuÃ¡rio digita mensagem e clica ENVIAR                                      â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸŸª [CHAT_REP_V2] â•â•â• ENVIANDO MENSAGEM â•â•â•                                â”‚
â”‚    ğŸ“Œ ConteÃºdo: "<mensagem>"                                                â”‚
â”‚    ğŸ“Œ Conversa ID: <uuid>                                                   â”‚
â”‚    ğŸ“Œ Condominio ID: <uuid>                                                 â”‚
â”‚    ğŸ“Œ Representante ID: <uuid>                                              â”‚
â”‚    ğŸ“Œ Representante Nome: <nome>                                            â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ”„ [CHAT_REP_V2] Chamando MensagensService.enviar()...                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             ğŸŸ¨ MENSAGENS_SERVICE (Amarelo Claro)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸŸ¨ [MENSAGENS_SERVICE] â•â•â• ENVIAR MENSAGEM â•â•â•                             â”‚
â”‚    ğŸ“Œ Conversa ID: <uuid>                                                   â”‚
â”‚    ğŸ“Œ Condominio ID: <uuid>                                                 â”‚
â”‚    ğŸ“Œ Remetente Tipo: representante                                         â”‚
â”‚    ğŸ“Œ Remetente ID: <uuid>                                                  â”‚
â”‚    ğŸ“Œ Remetente Nome: <nome>                                                â”‚
â”‚    ğŸ“Œ ConteÃºdo: "<mensagem>"                                                â”‚
â”‚    ğŸ“Œ Tipo ConteÃºdo: texto                                                  â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ”„ [MENSAGENS_SERVICE] Inserindo mensagem no Supabase...                  â”‚
â”‚    ğŸ“¦ Dados: {conversa_id, condominio_id, remetente_tipo, ...}              â”‚
â”‚   â†“                                                                          â”‚
â”‚ âœ… [MENSAGENS_SERVICE] Mensagem inserida com sucesso!                       â”‚
â”‚    ğŸ“Œ Resultado: {id, status, created_at, ...}                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             ğŸ”µ CONVERSAS_SERVICE (ContinuaÃ§Ã£o)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ De volta em [CHAT_REP_V2]                                                   â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ”„ [CHAT_REP_V2] Atualizando Ãºltima mensagem na conversa...                â”‚
â”‚   â†“                                                                          â”‚
â”‚ ğŸ”µ [CONVERSAS_SERVICE] Atualizando Ãºltima mensagem                         â”‚
â”‚    ğŸ“Œ Conversa ID: <uuid>                                                   â”‚
â”‚    ğŸ“Œ Preview: "<mensagem>"                                                 â”‚
â”‚    ğŸ“Œ Por: representante                                                    â”‚
â”‚    ğŸ”„ Atualizando no Supabase...                                            â”‚
â”‚    âœ… Ãšltima mensagem atualizada                                            â”‚
â”‚   â†“                                                                          â”‚
â”‚ âœ… [CHAT_REP_V2] Conversa atualizada                                        â”‚
â”‚   â†“                                                                          â”‚
â”‚ Limpar input e scroll para baixo                                            â”‚
â”‚   â†“                                                                          â”‚
â”‚ âœ… FLUXO COMPLETO SUCESSO                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Legenda de Cores

| Cor | Componente | Arquivo |
|-----|-----------|---------|
| ğŸŸ¦ Azul | PortariaRepresentanteScreen | `portaria_representante_screen.dart` |
| ğŸŸ© Verde | ConversasSimples | `conversas_simples_screen.dart` |
| ğŸŸª Roxo | ChatRepresentanteScreenV2 | `chat_representante_screen_v2.dart` |
| ğŸŸ¨ Amarelo | MensagensService | `mensagens_service.dart` |
| ğŸ”µ Azul Escuro | ConversasService | `conversas_service.dart` |

---

## âœ… Checklist de Logs Esperados

Ao enviar uma mensagem, vocÃª deve ver todos esses logs (em ordem):

- [ ] ğŸŸª `[CHAT_REP_V2] â•â•â• ENVIANDO MENSAGEM â•â•â•`
- [ ] ğŸ“Œ `ConteÃºdo: "<sua mensagem>"`
- [ ] ğŸ“Œ `Representante ID: <uuid vÃ¡lido>`
- [ ] ğŸ”„ `[CHAT_REP_V2] Chamando MensagensService.enviar()...`
- [ ] ğŸŸ¨ `[MENSAGENS_SERVICE] â•â•â• ENVIAR MENSAGEM â•â•â•`
- [ ] ğŸ“Œ `Remetente ID: <uuid vÃ¡lido>`
- [ ] ğŸ”„ `[MENSAGENS_SERVICE] Inserindo mensagem no Supabase...`
- [ ] âœ… `[MENSAGENS_SERVICE] Mensagem inserida com sucesso!`
- [ ] ğŸ”µ `[CONVERSAS_SERVICE] Atualizando Ãºltima mensagem`
- [ ] âœ… `[CONVERSAS_SERVICE] Ãšltima mensagem atualizada`
- [ ] âœ… `[CHAT_REP_V2] Conversa atualizada`

**Se vir tudo isso, a mensagem foi enviada com sucesso!** âœ…

---

## ğŸ” Como Debugar Usando Este Mapa

### CenÃ¡rio 1: Mensagem nÃ£o enviada

1. Procure por ğŸŸ¨ `[MENSAGENS_SERVICE]`
2. Se nÃ£o encontrar, erro estÃ¡ em `[CHAT_REP_V2]`
3. Se encontrar âŒ, veja qual foi o erro PostgreSQL

### CenÃ¡rio 2: Representante ID vazio

1. Procure por ğŸŸª `[CHAT_REP_V2] â•â•â• ENVIANDO`
2. Verifique se `Representante ID: <uuid>`
3. Se estiver vazio, erro estÃ¡ em ğŸŸ¦ `[PORTARIA_REP]`

### CenÃ¡rio 3: Conversa nÃ£o marca como lida

1. Procure por ğŸ”µ `[CONVERSAS_SERVICE] Marcando`
2. Se nÃ£o encontrar, erro estÃ¡ em ğŸŸ© `[CONVERSAS_SIMPLES]`
3. Se encontrar âŒ, veja qual foi o erro Supabase

---

## ğŸš€ PrÃ³xima AÃ§Ã£o

**Teste agora!** Execute:

```bash
flutter run -v 2>&1 | tee debug_$(date +%s).log
```

EntÃ£o:
1. Navegue atÃ© Portaria â†’ Tab "Mensagem"
2. Clique em uma conversa
3. Envie uma mensagem
4. Procure por todos os logs acima

Compartilhe os logs comigo se houver qualquer âŒ!

